user_flows:
  - id: "FLOW-001"
    name: "User Authentication"
    actor: "Professional Accountant"
    description: "Azure AD SSO login to access the system"
    steps:
      - screen: "SCR-001"
        action: "Click SSO login button"
        success_target: "SCR-002"
        error_target: "SCR-001"
        notes: "Azure AD handles authentication, redirect to search dashboard on success"
    requirement_refs: ["Azure AD SSO integration requirement"]

  - id: "FLOW-002"
    name: "Basic Memo Search"
    actor: "Professional Accountant"
    description: "Search for memos using keywords and optional filters"
    steps:
      - screen: "SCR-002"
        action: "Enter search query and click search"
        success_target: "SCR-003"
        error_target: "SCR-002"
        notes: "Show validation if empty query, display loading state during search"
      - screen: "SCR-003"
        action: "Review search results with AI-generated similarities/differences"
        notes: "Results show relevance scores and brief explanations"
    requirement_refs: ["Semantic search across memo corpus", "LLM-generated similarities/differences analysis"]

  - id: "FLOW-003"
    name: "Filtered Memo Search"
    actor: "Professional Accountant"
    description: "Search with date range and other filters applied"
    steps:
      - screen: "SCR-002"
        action: "Toggle filters panel and set date range"
        success_target: "SCR-002"
        notes: "Filters panel expands to show date picker and other filter options"
      - screen: "SCR-002"
        action: "Enter search query with filters and click search"
        success_target: "SCR-003"
        error_target: "SCR-002"
        notes: "Search includes filter criteria in query processing"
      - screen: "SCR-003"
        action: "Review filtered search results"
        notes: "Results reflect applied filters, show active filter indicators"
    requirement_refs: ["Optional filters by guidance topic, personnel, etc."]

  - id: "FLOW-004"
    name: "View Memo Details"
    actor: "Professional Accountant"
    description: "Navigate from search results to full memo content"
    steps:
      - screen: "SCR-003"
        action: "Click on memo result item to view details"
        success_target: "SCR-004"
        notes: "Memo opens in detail view with full content and metadata"
      - screen: "SCR-004"
        action: "Read memo content and metadata"
        notes: "Full memo text displayed with clearance date, guidance references"
    requirement_refs: ["Memo detail view with full text and metadata"]

  - id: "FLOW-005"
    name: "Generate Memo Summary"
    actor: "Professional Accountant"
    description: "Request AI-generated summary of memo content"
    steps:
      - screen: "SCR-003"
        action: "Click summarize action on search result"
        success_target: "SCR-005"
        notes: "Navigate directly to summary view from search results"
      - screen: "SCR-005"
        action: "Review AI-generated bullet-point summary"
        notes: "Summary shows key topics and condensed content"
    requirement_refs: ["LLM-powered summarization into key points"]

  - id: "FLOW-006"
    name: "Generate Summary from Detail View"
    actor: "Professional Accountant"
    description: "Request summary while viewing full memo details"
    steps:
      - screen: "SCR-004"
        action: "Click summarize button in memo detail view"
        success_target: "SCR-005"
        notes: "Navigate to summary view from detail view"
      - screen: "SCR-005"
        action: "Review summary and optionally return to detail view"
        notes: "Back button available to return to full memo"
    requirement_refs: ["Summarization from memo detail view"]

  - id: "FLOW-007"
    name: "Draft New Memo"
    actor: "Professional Accountant"
    description: "Create new memo based on retrieved content and fact patterns"
    steps:
      - screen: "SCR-003"
        action: "Click 'Draft New' action on relevant search result"
        success_target: "SCR-006"
        notes: "Navigate to drafting interface with context from selected memo"
      - screen: "SCR-006"
        action: "Enter fact pattern and select memo template"
        notes: "AI assists with structure generation based on retrieved content"
    requirement_refs: ["Draft new memos based on retrieved content", "AI-assisted draft structure generation"]

  - id: "FLOW-008"
    name: "Draft from Memo Detail"
    actor: "Professional Accountant"
    description: "Start drafting process from memo detail view"
    steps:
      - screen: "SCR-004"
        action: "Click 'Draft New' button in memo detail view"
        success_target: "SCR-006"
        notes: "Navigate to drafting with full memo context"
      - screen: "SCR-006"
        action: "Use memo content as reference for new draft"
        notes: "System pre-populates relevant guidance references and structure"
    requirement_refs: ["Draft new memo from detail view"]

  - id: "FLOW-009"
    name: "Draft from Summary View"
    actor: "Professional Accountant"
    description: "Create new memo after reviewing summary"
    steps:
      - screen: "SCR-005"
        action: "Click 'Draft New' button in summary view"
        success_target: "SCR-006"
        notes: "Navigate to drafting with summarized content as context"
      - screen: "SCR-006"
        action: "Create draft incorporating key points from summary"
        notes: "AI uses summary insights for draft structure suggestions"
    requirement_refs: ["Draft new memo from summary view"]

  - id: "FLOW-010"
    name: "Navigation Between Views"
    actor: "Professional Accountant"
    description: "Navigate back through the application hierarchy"
    steps:
      - screen: "SCR-004"
        action: "Click back button to return to search results"
        success_target: "SCR-003"
        notes: "Maintain search context and scroll position"
      - screen: "SCR-005"
        action: "Click back button to return to previous view"
        success_target: "SCR-004"
        notes: "Return to memo detail view that led to summary"
    requirement_refs: ["Navigation between memo views"]

  - id: "FLOW-011"
    name: "Search from Header"
    actor: "Professional Accountant"
    description: "Perform new search from any page using header search"
    steps:
      - screen: "SCR-003"
        action: "Enter new query in header search input"
        success_target: "SCR-003"
        notes: "Update results without losing current page context"
      - screen: "SCR-004"
        action: "Use header search to find different memos"
        success_target: "SCR-003"
        notes: "Navigate back to results view with new search"
      - screen: "SCR-005"
        action: "Search for related content from summary view"
        success_target: "SCR-003"
        notes: "New search replaces current results"
    requirement_refs: ["Search functionality available from all pages"]

  - id: "FLOW-012"
    name: "User Session Management"
    actor: "Professional Accountant"
    description: "Handle user menu actions and session management"
    steps:
      - screen: "SCR-002"
        action: "Click user menu to access profile options"
        notes: "Dropdown shows logout and profile options"
      - screen: "SCR-003"
        action: "Access user menu from any authenticated page"
        notes: "Consistent user menu available across all screens"
      - screen: "SCR-004"
        action: "Logout from user menu"
        success_target: "SCR-001"
        notes: "Clear session and redirect to login"
    requirement_refs: ["User session management and logout"]
    _implied: true

  - id: "FLOW-013"
    name: "Error Handling - Search Failure"
    actor: "Professional Accountant"
    description: "Handle search errors and network issues"
    steps:
      - screen: "SCR-002"
        action: "Submit search query that fails due to network error"
        error_target: "SCR-002"
        notes: "Show error message, allow retry, maintain user input"
      - screen: "SCR-003"
        action: "Handle empty search results"
        notes: "Display 'no results found' message with search refinement suggestions"
    requirement_refs: ["Error handling for search functionality"]
    _implied: true

  - id: "FLOW-014"
    name: "Error Handling - Content Loading"
    actor: "Professional Accountant"
    description: "Handle errors when loading memo content"
    steps:
      - screen: "SCR-003"
        action: "Click memo that fails to load"
        error_target: "SCR-003"
        notes: "Show error message, option to retry or return to results"
      - screen: "SCR-004"
        action: "Handle memo content loading failure"
        error_target: "SCR-003"
        notes: "Display error state with back to results option"
    requirement_refs: ["Error handling for memo content access"]
    _implied: true